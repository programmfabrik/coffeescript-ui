// Button sizes
@mixin button-size($height, $padding-x, $font-size, $border-radius) {
	height: $height;
	min-width: $btn-visually-square-factor * $height; // make icon-only buttons optically square
	font-size: $font-size;
	line-height: $height; // force the button text to align center, especially the small button needs a seemingly larger lh
	border-radius: $border-radius;

	.cui-button-left {
		padding-left: $padding-x;
		margin-right: -0.5*$padding-x;

		// reset, do not use :not, so we can easily override these styles if needed
		&:empty,
		&:only-child {
			padding-left: 0;
			margin-right: 0;
		}
	}

	.cui-button-right {
		padding-right: $padding-x;
		margin-left: -0.5*$padding-x;

		// reset, do not use :not, so we can easily override these styles if needed
		&:empty,
		&:only-child {
			padding-right: 0;
			margin-left: 0;
		}
	}

	.cui-button-center {
		@include text-truncate();

		padding: 0 $padding-x;

		// there are some button that have an empty center element, adjust accordingly
		&:empty {
			margin-left: -0.5*$padding-x;
		}
	}
}

@mixin button-ellipsis() {
	.cui-button-visual {
		@include button-size(18px, 0, 18px, $btn-border-radius-sm); // fake baseline alignment via line-height/height 

		min-width: 0;
		width: 8px;
	}
}

@mixin button-icon() {
	.cui-button-visual {
		@include button-size($btn-height-xs, 0, $font-size-sm, 0);
	}
}


@mixin button-sm() {
	.cui-button-visual {
		@include button-size($btn-height-sm, $btn-padding-x-sm, $btn-font-size-sm, $btn-border-radius-sm);
	}
}

@mixin button-md() {
	.cui-button-visual {
		@include button-size($btn-height, $btn-padding-x, $btn-font-size, $btn-border-radius);
	}
}

@mixin button-lg() {
	.cui-button-visual {
		@include button-size($btn-height-lg, $btn-padding-x-lg, $btn-font-size-lg, $btn-border-radius-lg);
	}
}

@mixin button-xs() {
	.cui-button-visual {
		@include button-size(16px, 0.25em, 12px, 2px);
	}
}

@mixin button-color($background: $btn-background, $color: $btn-color, $background-hover: $btn-hover-background, $color-hover: $btn-hover-color, $background-active: $btn-active-background, $color-active: $btn-active-color) {
	.cui-button-visual {
		background-color: $background;
		color: $color;
	}

	&:hover,
	&:focus {
		.cui-button-visual {
			color: $color-hover;
			background-color: $background-hover;
		}
	}

	&:focus {
		outline: none;

		.cui-button-visual {
			@include button-focus();
		}
	}

	&:active {
		.cui-button-visual {
			color: $color-hover;
			background-color: darken($background-hover, 6%);
		}
	}

	&.cui-active,
	&.cui-layer-open {
		.cui-button-visual {
			color: $color-active;
			background-color: $background-active;
		}

		&:hover,
		&:focus {
			.cui-button-visual {
				color: $color-active;
				background-color: $background-active;
			}
		}
	}
}

@mixin button-color-reset($background: transparent, $color: $body-color) {
	@include button-color($background, $color, $background, $color, $background, $color);
}

@mixin button-primary() {
	$background: $btn-primary-background;
	$color: color-yiq($btn-primary-background);

	$background-hover: darken($btn-primary-background, 10%);
	$color-hover: $color;

	$background-active: $background-hover;
	$color-active: $color;

	@include button-color($background, $color, $background-hover, $color-hover, $background-active, $color-active);
}

@mixin button-secondary() {
	$background: $btn-secondary-background;
	$color: color-yiq($btn-secondary-background);

	$background-hover: darken($btn-secondary-background, 5%);
	$color-hover: $color;

	$background-active: $background-hover;
	$color-active: $color;

	@include button-color($background, $color, $background-hover, $color-hover, $background-active, $color-active);
}

@mixin button-inverted($border: 0) {
	$background: $btn-inverted-background;
	$color: $btn-inverted-color;

	$background-hover: $btn-inverted-hover-background;
	$color-hover: $btn-inverted-hover-color;

	$background-active: $background-hover;
	$color-active: $color;

	@include button-color($background, $color, $background-hover, $color-hover, $background-active, $color-active);
	
	@if $border == 1 {
		.cui-button-visual {
			border-color: $btn-inverted-border-color;
		}

		&:hover {
			.cui-button-visual {
				border-color: $btn-inverted-hover-border-color;
			}
		}
	}
}

@mixin button-link() {
	@include button-color(transparent, $link-color, transparent, $link-color, transparent, $link-color);

	.cui-button-visual {
		height: auto;

		.cui-button-center {
			text-decoration: underline;
			word-break: break-all;
		}

		.cui-button-center:first-child,
		.cui-button-left:empty + .cui-button-center {
			padding-left: 0;
		}

		.cui-button-center:last-child,
		.cui-button-center:only-child {
			padding-right: 0;
		}
	}

	&:hover,
	&:focus {
		.cui-button-visual .cui-button-center {
			text-decoration: none;
		}
	}
}

@mixin button-link-sm() {
	@include button-link();
	
	.cui-button-visual {
		font-size: $btn-font-size-sm;
		line-height: $line-height-sm;
	}
}

@mixin button-bordered($border-color: $btn-border-color) {
	.cui-button-visual {
		border: $btn-border-width solid $border-color;
	}
	
	@include button-color(transparent, $btn-color, $btn-bordered-hover-background, $btn-bordered-hover-color, $btn-bordered-active-background, $btn-bordered-active-color);
	
	&:focus .cui-button-visual {
		border-color: theme-color('focused');
		box-shadow: $btn-focus-shadow !important;
	}
}

@mixin button-focus() {
	outline: none;
	box-shadow: 0 0 0 1px $input-focus-border-color, $btn-focus-shadow !important;
}


@mixin disable-button-focus() {
	box-shadow: none;
	outline: 0;
	z-index: 0;
}

@mixin button-combobox($button-position: 'right') {
	// applied to .cui-button-button

	height: 100%;
	
	.cui-button-visual {
		display: flex;
		height: 100%;
		align-items: flex-start; // in case we have a textarea input or any other longer left input, the icon should always be top aligned
		background-color: $combobox-input-background;
		border: 1px solid $combobox-border-color;

		@if $button-position == 'right' {
			border-left: var(--combobox-divider-border, #{$combobox-divider-border});
			border-top-left-radius: 0;
			border-bottom-left-radius: 0;
		}
		@else if $button-position == 'left' {
			z-index: 1;
			position: relative;
			border-right: var(--combobox-divider-border, #{$combobox-divider-border});
			border-top-right-radius: 0;
			border-bottom-right-radius: 0;
		}

		// usually contains the icon
		.cui-button-left {
			@include button-combobox-center-icon();
		}
	}

	&.cui-layer-open,
	&.cui-layer-open:hover,
	&.cui-active,
	&.cui-active:hover {
		.cui-button-visual {
			background-color: $btn-active-background;
			color: $btn-active-color;

			@if $button-position == 'right' {
				border-left-color: $btn-active-background !important;
			}
			@else if $button-position == 'left' {
				border-right-color: $btn-active-background !important;
			}
		}
	}

	// todo: hover
	&:hover {
		.cui-button-visual {
			background-color: $input-background;
		}
	}
	
	&:focus {
		z-index: 1;
	
		.cui-button-visual {
			border-radius: $input-border-radius !important;
			border-color: $input-focus-border-color !important;
			box-shadow: $btn-focus-shadow !important;
		}
	}
}

// we need to set an explicit icon container height and vertically center the icon within, 
// because the parent .cui-button-visual needs to have flex align-items: flex-start
// this way the icon will always be centered optically within its container
@mixin button-combobox-center-icon() {
	min-height: $btn-height - 2px;
	display: flex;
	align-items: center;
}

@mixin button-info-icon() {
	@include button-sm();

	.cui-button-visual {
		height: 1.3em;
		min-width: 1.3em;
		margin-left: 0.25rem;
	}

	.cui-button-left {
		padding: 0;

		.svg-info-circle {
			width: clamp(10px, 1em, 14px);
			height: clamp(10px, 1em, 14px);
		}
	}
}
